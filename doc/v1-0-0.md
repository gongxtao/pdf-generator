# 生成PDF的业务逻辑
1. 用户选择模板，输入内容;
2. 输入内容可以是用户上传的文档或者用户自己填写的内容;
3. 用户点击生成PDF按钮，系统将根据用户选择的模板和输入的内容生成PDF文件;
4. 用户可以查看和下载PDF文件。

# 生成PDF的技术路线
1. **模板**: 模板是一个image/webp的图片，模板内容根据CSS代码展示的示例图片，实际上PDF模板是一段CSS的代码；
2. **内容**: 内容可以是用户上传的文档或者用户自己填写的内容；
   - 上传文档: 支持用户上传Word、Excel、PPT等文档，系统将文档的内容提取出来，填充到富文本编辑器里；
   - 填写内容: 用户如果不上传文档，可以在富文本编辑器里填写内容。
3. **生成PDF**: 当用户点击生成PDF按钮时，系统将获取模板关联的CSS代码，根据CSS代码+文本内容生成HTML代码（页面），然后使用puppeteer库将HTML代码转换为PDF文件；
4. **存储**: 生成的PDF文件存储在本地目录（/pdf），用户可以通过链接查看和下载。

## 模板的分类
1. 报告模版如下:
```json
[
    {
        "id": "business_proposal30",
        "category": "business",
        "title": "Document Template 30",
        "description": "TBC",
        "image_url": "/static/business/business_proposal30.webp",
        "alt_text": "Bold document template featuring a red, blue, and white color scheme. Uses a strong sans-serif font for hierarchical headings with distinct borders and accents (thick blue/red lines, dotted blue). Includes red list markers, a table with a blue gradient header and accent borders, a prominent blue highlight block with a red left border, and red links with blue underlines. Clean layout using a standard body sans-serif font.",
        "template_content": "@import url('https://fonts.googleapis.com/css2?family=Oswald:wght@400;700&family=Lato:wght@400;700&display=swap');\n\n/* IMPORTANT Do not modify this stylesheet in any way unless explicitly instructed */\n/* IMPORTANT - When dealing with Arabic text, employ lang=\"ar\" and dir=\"rtl\" and make any \"border-left:\" to be \"border-right:\" to ensure they display on the right side of the page and align with the Arabic text.*/\n\n:root {\n--primary-red: #E4002B;\n--primary-blue: #0033A0;\n--accent-blue: #007FFF;\n--text-color: #333333;\n--background-color: #FFFFFF;\n\n--h1-color: var(--primary-red);\n--h2-color: var(--primary-blue);\n--h3-color: var(--primary-red);\n--h4-color: var(--accent-blue);\n--h5-color: var(--text-color);\n--h6-color: var(--text-color);\n}\n\nh1, h2, h3, h4, h5, h6 {\nfont-family: 'Oswald', sans-serif;\nfont-weight: 700;\n}\n\nh1, .cover-page-main-title {\nfont-size: 24pt;\ntext-align: center;\nmargin-bottom: 0.3in;\ncolor: var(--h1-color);\nposition: relative;\npadding-bottom: 10px;\nborder-bottom: 4px solid var(--primary-blue);\n}\n\nh1::before, .cover-page-main-title::before {\ncontent: \"\"\"\";\nposition: absolute;\nbottom: -14px;\nleft: 50%;\ntransform: translateX(-50%);\nwidth: 60%;\nheight: 4px;\nbackground-color: var(--primary-red);\n}\n\nh2 {\nfont-size: 18pt;\ncolor: var(--h2-color);\nposition: relative;\npadding-left: 20px;\nmargin-top: 0.4in;\nmargin-bottom: 0.2in;\nborder-left: 8px solid var(--primary-red);\nline-height: 1.5;\n}\n\nh3 {\nfont-size: 16pt;\ncolor: var(--h3-color);\nmargin-top: 0.3in;\nmargin-bottom: 0.15in;\nborder-bottom: 2px dotted var(--accent-blue);\npadding-bottom: 5px;\n}\n\nh4 {\nfont-size: 14pt;\ncolor: var(--h4-color);\nmargin-top: 0.2in;\nmargin-bottom: 0.1in;\nposition: relative;\n}\n\nh4::before {\nposition: absolute;\nleft: 0;\ncolor: var(--primary-red);\nfont-size: 1em;\ntop: 50%;\ntransform: translateY(-50%);\n}\n\nh5 {\nfont-size: 12pt;\ncolor: var(--h5-color);\nfont-weight: 700;\nmargin-top: 0.15in;\nmargin-bottom: 0.05in;\n}\n\nh6 {\nfont-size: 11pt;\ncolor: var(--h6-color);\nfont-weight: 400;\nmargin-top: 0.1in;\nmargin-bottom: 0.05in;\n}\n\n/* Never make adjustments to the body CSS */\nbody {\nfont-family: 'Lato', sans-serif;\ncolor: var(--text-color);\nbox-sizing: border-box;\nbackground-color: var(--background-color);\nline-height: 1.5;\n}\n\n/* Use this for Arabic text and design elements*/\n.rtl {\ndirection: rtl;\n}\n\n/* Use this highlight-block class sparingly. Only apply it to content that really stands out from the rest.*/\n.highlight-block {\nbackground-color: var(--primary-blue);\ncolor: var(--background-color);\npadding: 0.25in;\nmargin-bottom: 0.2in;\nmargin-top: 0.2in;\nborder-radius: 10px;\nborder-left: 8px solid var(--primary-red);\nfont-weight: 400;\nposition: relative;\noverflow: hidden;\n}\n\n.highlight-block p {\ncolor: var(--background-color);\n}\n\nli::marker {\ncolor: var(--primary-red);\nfont-weight: bold;\n}\n\n.marker {\ncolor: var(--primary-red);\nfont-weight: bold;\nmargin-right: 0.5em;\n}\n\n.table-title {\nfont-weight: bold;\nmargin-bottom: 10px;\npage-break-after: avoid;\nfont-size: 14pt;\ncolor: var(--primary-blue);\ntext-transform: uppercase;\n}\n\ntable {\ntable-layout: fixed;\nwidth: 100%;\nborder-collapse: collapse;\nborder-spacing: 0;\nmargin-bottom: 40px;\nborder: 2px solid var(--primary-blue);\nborder-radius: 8px;\noverflow: hidden;\n}\n\nth, td {\nborder: 1px solid var(--accent-blue);\nword-wrap: break-word;\noverflow-wrap: break-word;\nmax-width: 1px;\npadding: 12px 4px;\ntext-align: center;\nfont-size: 10pt;\nfont-weight: 400;\ncolor: var(--text-color);\n}\n\ntable th {\ncolor: var(--background-color);\nbackground-color: var(--primary-blue);\nfont-weight: 500;\nfont-size: 10pt;\ntext-transform: uppercase;\nhyphens: auto;\n}\n\ntd {\nline-height: 1.4;\n}\n\nthead tr {\nbackground: linear-gradient(to right, var(--primary-blue), var(--accent-blue));\ncolor: white;\n}\n\ntr:nth-child(odd) {\nbackground-color: #F0F8FF;\n}\n\ntr:nth-child(even) {\nbackground-color: var(--background-color);\n}\n\n/* !!!*!!! Use this on tables where the first column SHOULD be highlighted. */\n.highlight-first-col td:first-child {\n  color: white;\n  background: var(--primary-blue);\n  font-weight: 500;\n  text-transform: uppercase;\n  hyphens: auto;\n}\n\na {\ncolor: var(--primary-red);\ntext-decoration: underline;\ntext-decoration-color: var(--accent-blue);\ntext-underline-offset: 3px;\n}\n\nblockquote {\nfont-style: italic;\nborder-left: 5px solid var(--accent-blue);\npadding-left: 15px;\nmargin-left: 0;\ncolor: #555555;\n}\n\nhr {\nborder: none;\nheight: 3px;\nbackground: linear-gradient(to right, var(--primary-red), var(--primary-blue));\nmargin: 30px 0;\n}\n\n /* !!!*!!! Only implement .cover-page class if provided with cover page text */\n.cover-page {\n}\n\n.cover-page-subtitles {\n}\n\n.cover-page-subtitles {\n}\n\n/* Use this for any field lines and text placeholders. Example: <div class=\"form-line\"> <span>Example Text:</span> <span>_______________________</span> </div> */\n.form-line {\nmargin: 15px 0;\nwhite-space: normal;\noverflow: hidden;\n}",
        "display_order": 1,
        "source": "database",
        "header_file": null,
        "footer_file": null
    }
]
```